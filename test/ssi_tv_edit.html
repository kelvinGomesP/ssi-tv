<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSI TV - Dashboard Corporativo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #0047AB;
            color: white;
            padding: 15px 0;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        
        h1 {
            font-size: 24px;
        }
        
        .tab-navigation {
            display: flex;
            margin-bottom: 20px;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .tab-button {
            flex: 1;
            padding: 15px;
            text-align: center;
            background-color: #e9ecef;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .tab-button.active {
            background-color: #0047AB;
            color: white;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        button {
            background-color: #0047AB;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #003380;
        }
        
        button.secondary {
            background-color: #6c757d;
        }
        
        button.secondary:hover {
            background-color: #5a6268;
        }
        
        .preview-container {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            background-color: #f8f9fa;
        }
        
        .preview-title {
            font-size: 20px;
            margin-bottom: 10px;
            color: #0047AB;
        }
        
        .preview-image {
            max-width: 100%;
            max-height: 300px;
            display: block;
            margin: 0 auto 15px;
            border-radius: 4px;
        }
        
        /* Estilos para a página de visualização (TV) */
        #tv-view {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 1000;
            display: none;
        }
        
        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        .slide.active {
            display: flex;
        }
        
        .powerbi-slide iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .news-slide {
            background-size: cover;
            background-position: center;
        }
        
        .news-content {
            background-color: rgba(0, 0, 0, 0.7);
            padding: 30px;
            border-radius: 8px;
            max-width: 80%;
        }
        
        .news-title {
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        
        .news-description {
            font-size: 1.5em;
            line-height: 1.5;
        }
        
        .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1001;
        }
        
        .controls button {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .controls button:hover {
            background-color: rgba(255, 255, 255, 0.4);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            background-color: #4CAF50;
            color: white;
            border-radius: 4px;
            display: none;
            z-index: 1002;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SSI TV - Painel Corporativo</h1>
        </header>
        
        <div class="tab-navigation">
            <button class="tab-button active" onclick="openTab('edit-tab')">Editar Conteúdo</button>
            <button class="tab-button" onclick="openTab('preview-tab')">Pré-visualizar</button>
            <button class="tab-button" onclick="openTab('settings-tab')">Configurações</button>
        </div>
        
        <div id="edit-tab" class="tab-content active">
            <h2>Adicionar Nova Notícia/Evento</h2>
            
            <div class="form-group">
                <label for="news-title">Título:</label>
                <input type="text" id="news-title" placeholder="Digite o título da notícia ou evento">
            </div>
            
            <div class="form-group">
                <label for="news-description">Descrição:</label>
                <textarea id="news-description" placeholder="Digite a descrição ou detalhes"></textarea>
            </div>
            
            <div class="form-group">
                <label for="news-image">URL da Imagem:</label>
                <input type="text" id="news-image" placeholder="Cole o URL da imagem ou faça upload">
                <input type="file" id="image-upload" accept="image/*" style="margin-top: 10px;">
            </div>
            
            <div class="form-group">
                <label for="display-time">Tempo de exibição (segundos):</label>
                <input type="number" id="display-time" value="10" min="5">
            </div>
            
            <button onclick="addNews()">Adicionar Notícia</button>
            <button onclick="clearForm()" class="secondary">Limpar Campos</button>
            
            <h2 style="margin-top: 30px;">Configurar Painel Power BI</h2>
            
            <div class="form-group">
                <label for="powerbi-url">URL do Relatório Power BI:</label>
                <input type="text" id="powerbi-url" placeholder="Cole o URL de incorporação do Power BI">
            </div>
            
            <div class="form-group">
                <label for="powerbi-time">Tempo de exibição (segundos):</label>
                <input type="number" id="powerbi-time" value="30" min="10">
            </div>
            
            <button onclick="savePowerBiConfig()">Salvar Configuração Power BI</button>
        </div>
        
        <div id="preview-tab" class="tab-content">
            <h2>Pré-visualização do Conteúdo</h2>
            
            <div class="preview-container">
                <div class="preview-title">Power BI</div>
                <div id="powerbi-preview" style="height: 300px; background-color: #ddd; display: flex; justify-content: center; align-items: center;">
                    <p>Visualização do Power BI aparecerá aqui</p>
                </div>
                <p style="margin-top: 10px;">Tempo de exibição: <span id="powerbi-time-preview">30</span> segundos</p>
            </div>
            
            <div id="news-preview-container">
                <!-- As notícias serão adicionadas aqui via JavaScript -->
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button onclick="startPresentation()">Iniciar Apresentação na TV</button>
                <button onclick="openTab('edit-tab')" class="secondary">Voltar para Editar</button>
            </div>
        </div>
        
        <div id="settings-tab" class="tab-content">
            <h2>Configurações do Sistema</h2>
            
            <div class="form-group">
                <label for="transition-time">Tempo de transição entre slides (ms):</label>
                <input type="number" id="transition-time" value="1000" min="100">
            </div>
            
            <div class="form-group">
                <label for="auto-start">Iniciar automaticamente ao abrir a página de visualização:</label>
                <select id="auto-start">
                    <option value="yes">Sim</option>
                    <option value="no">Não</option>
                </select>
            </div>
            
            <button onclick="saveSettings()">Salvar Configurações</button>
        </div>
    </div>
    
    <div id="tv-view">
        <div class="slide powerbi-slide">
            <iframe id="powerbi-frame" src="" frameborder="0"></iframe>
        </div>
        
        <div class="slide news-slide" id="news-template" style="display: none;">
            <div class="news-content">
                <h2 class="news-title"></h2>
                <p class="news-description"></p>
            </div>
        </div>
        
        <div class="controls">
            <button onclick="exitPresentation()">Sair</button>
            <button onclick="pausePlayPresentation()">Pausar/Continuar</button>
        </div>
    </div>
    
    <div class="notification" id="notification">
        Alterações salvas com sucesso!
    </div>

    <script>
        // Variáveis globais
        let newsItems = [];
        let powerBiUrl = '';
        let powerBiDisplayTime = 30;
        let currentSettings = {
            transitionTime: 1000,
            autoStart: 'yes'
        };
        let isPresentationRunning = false;
        let presentationInterval;
        let currentSlideIndex = 0;
        
        // Carregar dados salvos ao iniciar
        window.addEventListener('DOMContentLoaded', function() {
            loadSavedData();
            updatePreview();
            
            // Configurar upload de imagem
            document.getElementById('image-upload').addEventListener('change', handleImageUpload);
        });
        
        // Funções de abas
        function openTab(tabId) {
            // Esconder todas as abas
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar a aba selecionada
            document.getElementById(tabId).classList.add('active');
            
            // Atualizar botões de navegação
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Se for a aba de preview, atualizar a visualização
            if (tabId === 'preview-tab') {
                updatePreview();
            }
        }
        
        // Manipulação de notícias
        function addNews() {
            const title = document.getElementById('news-title').value;
            const description = document.getElementById('news-description').value;
            const imageUrl = document.getElementById('news-image').value;
            const displayTime = parseInt(document.getElementById('display-time').value);
            
            if (!title || !description) {
                alert('Por favor, preencha pelo menos o título e a descrição.');
                return;
            }
            
            const newsItem = {
                id: Date.now(), // ID único baseado no timestamp
                title,
                description,
                imageUrl,
                displayTime
            };
            
            newsItems.push(newsItem);
            saveNews();
            clearForm();
            showNotification('Notícia adicionada com sucesso!');
            
            // Se estiver na aba de preview, atualizar
            if (document.getElementById('preview-tab').classList.contains('active')) {
                updatePreview();
            }
        }
        
        function clearForm() {
            document.getElementById('news-title').value = '';
            document.getElementById('news-description').value = '';
            document.getElementById('news-image').value = '';
            document.getElementById('display-time').value = '10';
        }
        
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('news-image').value = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }
        
        // Power BI
        function savePowerBiConfig() {
            powerBiUrl = document.getElementById('powerbi-url').value;
            powerBiDisplayTime = parseInt(document.getElementById('powerbi-time').value);
            
            localStorage.setItem('powerBiUrl', powerBiUrl);
            localStorage.setItem('powerBiDisplayTime', powerBiDisplayTime);
            
            showNotification('Configuração do Power BI salva!');
            
            // Se estiver na aba de preview, atualizar
            if (document.getElementById('preview-tab').classList.contains('active')) {
                updatePreview();
            }
        }
        
        // Configurações
        function saveSettings() {
            currentSettings.transitionTime = parseInt(document.getElementById('transition-time').value);
            currentSettings.autoStart = document.getElementById('auto-start').value;
            
            localStorage.setItem('tvSettings', JSON.stringify(currentSettings));
            showNotification('Configurações salvas!');
        }
        
        // Visualização
        function updatePreview() {
            // Atualizar preview do Power BI
            const powerBiPreview = document.getElementById('powerbi-preview');
            const powerBiTimePreview = document.getElementById('powerbi-time-preview');
            
            if (powerBiUrl) {
                powerBiPreview.innerHTML = `<iframe src="${powerBiUrl}" width="100%" height="100%" frameborder="0"></iframe>`;
            } else {
                powerBiPreview.innerHTML = '<p>URL do Power BI não configurado</p>';
            }
            powerBiTimePreview.textContent = powerBiDisplayTime;
            
            // Atualizar preview das notícias
            const newsContainer = document.getElementById('news-preview-container');
            newsContainer.innerHTML = '';
            
            if (newsItems.length === 0) {
                newsContainer.innerHTML = '<p>Nenhuma notícia adicionada ainda.</p>';
                return;
            }
            
            newsItems.forEach(news => {
                const newsElement = document.createElement('div');
                newsElement.className = 'preview-container';
                newsElement.innerHTML = `
                    <div class="preview-title">${news.title}</div>
                    ${news.imageUrl ? `<img src="${news.imageUrl}" class="preview-image" alt="${news.title}">` : ''}
                    <p>${news.description}</p>
                    <p style="margin-top: 10px;">Tempo de exibição: ${news.displayTime} segundos</p>
                    <button onclick="deleteNews(${news.id})" class="secondary">Excluir</button>
                `;
                newsContainer.appendChild(newsElement);
            });
        }
        
        function deleteNews(id) {
            newsItems = newsItems.filter(news => news.id !== id);
            saveNews();
            updatePreview();
            showNotification('Notícia excluída!');
        }
        
        // Apresentação na TV
        function startPresentation() {
            if (!powerBiUrl && newsItems.length === 0) {
                alert('Configure pelo menos o Power BI ou adicione notícias antes de iniciar.');
                return;
            }
            
            document.getElementById('tv-view').style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            // Preparar slides
            prepareSlides();
            
            // Iniciar apresentação
            currentSlideIndex = 0;
            isPresentationRunning = true;
            showSlide(currentSlideIndex);
            
            // Configurar transição automática
            startSlideTransition();
        }
        
        function prepareSlides() {
            // Limpar slides de notícias existentes (exceto o template)
            document.querySelectorAll('.slide.news-slide:not(#news-template)').forEach(slide => {
                slide.remove();
            });
            
            // Adicionar slide do Power BI se configurado
            const powerBiSlide = document.querySelector('.powerbi-slide');
            if (powerBiUrl) {
                document.getElementById('powerbi-frame').src = powerBiUrl;
                powerBiSlide.style.display = 'flex';
                powerBiSlide.dataset.displayTime = powerBiDisplayTime;
            } else {
                powerBiSlide.style.display = 'none';
            }
            
            // Adicionar slides de notícias
            newsItems.forEach(news => {
                const newsTemplate = document.getElementById('news-template');
                const newSlide = newsTemplate.cloneNode(true);
                newSlide.id = '';
                newSlide.style.display = 'flex';
                newSlide.dataset.displayTime = news.displayTime;
                
                if (news.imageUrl) {
                    newSlide.style.backgroundImage = `url('${news.imageUrl}')`;
                }
                
                newSlide.querySelector('.news-title').textContent = news.title;
                newSlide.querySelector('.news-description').textContent = news.description;
                
                document.getElementById('tv-view').appendChild(newSlide);
            });
        }
        
        function showSlide(index) {
            // Esconder todos os slides
            document.querySelectorAll('.slide:not(#news-template)').forEach(slide => {
                slide.classList.remove('active');
            });
            
            // Mostrar slide atual
            const slides = document.querySelectorAll('.slide:not(#news-template)');
            if (slides[index]) {
                slides[index].classList.add('active');
            }
        }
        
        function startSlideTransition() {
            if (presentationInterval) {
                clearInterval(presentationInterval);
            }
            
            presentationInterval = setInterval(() => {
                if (!isPresentationRunning) return;
                
                const slides = document.querySelectorAll('.slide:not(#news-template)');
                currentSlideIndex = (currentSlideIndex + 1) % slides.length;
                showSlide(currentSlideIndex);
            }, getCurrentSlideDisplayTime() * 1000);
        }
        
        function getCurrentSlideDisplayTime() {
            const slides = document.querySelectorAll('.slide:not(#news-template)');
            if (slides[currentSlideIndex]) {
                return parseInt(slides[currentSlideIndex].dataset.displayTime);
            }
            return 10; // Valor padrão
        }
        
        function exitPresentation() {
            document.getElementById('tv-view').style.display = 'none';
            document.body.style.overflow = 'auto';
            isPresentationRunning = false;
            
            if (presentationInterval) {
                clearInterval(presentationInterval);
                presentationInterval = null;
            }
        }
        
        function pausePlayPresentation() {
            isPresentationRunning = !isPresentationRunning;
            
            if (isPresentationRunning) {
                startSlideTransition();
            }
        }
        
        // Utilitários
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Armazenamento local
        function loadSavedData() {
            // Carregar notícias
            const savedNews = localStorage.getItem('newsItems');
            if (savedNews) {
                newsItems = JSON.parse(savedNews);
            }
            
            // Carregar configurações do Power BI
            const savedPowerBiUrl = localStorage.getItem('powerBiUrl');
            if (savedPowerBiUrl) {
                powerBiUrl = savedPowerBiUrl;
                document.getElementById('powerbi-url').value = powerBiUrl;
            }
            
            const savedPowerBiTime = localStorage.getItem('powerBiDisplayTime');
            if (savedPowerBiTime) {
                powerBiDisplayTime = parseInt(savedPowerBiTime);
                document.getElementById('powerbi-time').value = powerBiDisplayTime;
            }
            
            // Carregar configurações
            const savedSettings = localStorage.getItem('tvSettings');
            if (savedSettings) {
                currentSettings = JSON.parse(savedSettings);
                document.getElementById('transition-time').value = currentSettings.transitionTime;
                document.getElementById('auto-start').value = currentSettings.autoStart;
            }
        }
        
        function saveNews() {
            localStorage.setItem('newsItems', JSON.stringify(newsItems));
        }
    </script>
</body>
</html>